import numpy as np
from PIL import Image
from engine import PCA
import os
import argparse
import matplotlib.pyplot as plt
import time


class nn_config(object):

	def __init__(self):
		self.lr = 0.06
		self.iters = 500
		self.iters_add_interval = 5
		self.iters_add = 50


def main():
	parser = argparse.ArgumentParser()    
	parser.add_argument('--img_path', default='data/face/', type=str)
	parser.add_argument('--num_class', default=40, type=int)
	parser.add_argument('--num_per_class', default=10, type=int)
	parser.add_argument('--type', default='image', type=str,help='image or pixel')
	parser.add_argument('--method', default='cx', type=str,help='cx or nn')
	parser.add_argument('--sf', action='store_true', help='save pca features')
	opt = parser.parse_args()
	img_size = (112, 92)
	
	for i in range(opt.num_class):
	    for j in range(opt.num_per_class):
	        img = Image.open(opt.img_path+'s'+str(i+1)+'/'+str(j+1)+'.bmp')
	        img = (np.array(img).reshape(1,-1))/255
	        if i==0 and j==0:
	            imgs = img
	        else:
	            imgs = np.concatenate((imgs, img), axis=0)

	if opt.sf:
		np.save('feature_0.npy', imgs)
		
	if opt.type == 'pixel':
		imgs = imgs.T
	
	nn_opt = nn_config()
	time_start = time.time()
	pca = PCA(imgs, opt.method)
	pca.exec(m=350, config=nn_opt) 
	time_end = time.time()
	print('time:%f' % (time_end-time_start))
	# 35:m=293
	chosen_pics = list(range(399,400))
	chosen_pics = [4, 50, 150, 300]
	# ms = [1, 7, 150, 302, 350]#
	ms = list(range(1,351))
	psnrs = []
	# ms = [int(((1 - r) * d * N - d) / (d + N)) for r in compress_ratios]
	
	print(ms)

	for pic in chosen_pics:
	    if opt.type == 'pixel':
	    	img_o = imgs[:,pic].copy()
	    else:
	    	img_o = imgs[pic].copy()
	    img_o[img_o>1.0] = 1.0
	    img_o[img_o<0.0] = 0.0
	    Image.fromarray((img_o.reshape(img_size)*255.0).astype(np.uint8)).save('imgs/img_o_%d.bmp' % pic)


	for i in range(len(ms)):
	    m = ms[i]
	    us, mv, ys, out = pca.get_results(m)
	    if opt.sf:
	    	np.save('feature_%d.npy' % m, ys)
	    compressed = out + mv
	    mses = np.mean(np.power(imgs-compressed, 2), axis=1) 
	    psnr = np.mean(10 * np.log10((1 ** 2 / mses)))
	    psnrs.append(psnr)
	    print('psnr:%f' % psnr)
	    # save several classes
	    for pic in chosen_pics:
	    	if opt.type == 'pixel':
	    		img_p = compressed[:,pic].copy()
	    	else:
	    		img_p = compressed[pic].copy()
	    	img_p[img_p>1.0] = 1.0
	    	img_p[img_p<0.0] = 0.0
	    	Image.fromarray((img_p.reshape(img_size)*255.0).astype(np.uint8)).save(
	    		'imgs/img_m_%d_%d_%s_%s.bmp' % (m, pic, opt.type, opt.method))

	    print('m=%d completed' % m)
	print(psnrs)
	# image cx
	# m_ = [1, 9, 294] # 78,
	# p_ = [17.274898, 20.140303, 35.062892] # , 25.016306
	# psnrs_i = [17.274897849443388, 17.984866799734576, 18.429027682244417, 18.806370240796554, 19.205253279004708, 19.500137725565413, 19.71667271242219, 19.937310865190856, 20.14030301875385, 20.321821089583906, 20.479703036854982, 20.648392497104368, 20.784219033291382, 20.91581128002917, 21.042345465083343, 21.154480880496706, 21.27347244377829, 21.388294016863828, 21.49348517417234, 21.592431315886834, 21.688545157438384, 21.791110537455392, 21.884059955493367, 21.963628166252565, 22.052526487021293, 22.13230110418538, 22.210367237284316, 22.2860192194752, 22.360991430711973, 22.432736096952027, 22.50986630292992, 22.580453825113683, 22.651134307493624, 22.720649216741666, 22.792136611830546, 22.85961627577077, 22.92925523464973, 22.994660641426726, 23.058082831160345, 23.120394602454663, 23.177061112449202, 23.237086579998856, 23.29811669909442, 23.358655291761394, 23.41733720370162, 23.475321346443778, 23.532233006818952, 23.58699819849044, 23.643052832161693, 23.701135530973453, 23.756008427111897, 23.807204485611656, 23.86011705733056, 23.91263897950119, 23.965929855940544, 24.016273448203428, 24.06579474179344, 24.115299469622574, 24.16588974433949, 24.21347905656319, 24.262682564998418, 24.310174798760716, 24.358488774447693, 24.4054942991608, 24.450591985933325, 24.49640961858675, 24.54078985797506, 24.585733712353914, 24.63057240648958, 24.67322759463632, 24.716410614908064, 24.759193269984763, 24.802349149283017, 24.8447466410151, 24.88751985597507, 24.931468222085673, 24.974181943105453, 25.016305821831633, 25.057868329939453, 25.099982709725627, 25.14197435378943, 25.18369957220007, 25.226022269584163, 25.26563332939057, 25.306742494275877, 25.34826701057809, 25.389307005180953, 25.429919726414568, 25.47066168202818, 25.510478588899588, 25.55080088294847, 25.59125790592605, 25.630349792791886, 25.67041482322194, 25.709600709339426, 25.750728942361558, 25.78976518274329, 25.827316108550143, 25.866348822166174, 25.90314093111569, 25.941819580002665, 25.980003285750826, 26.018068022168396, 26.057783803646103, 26.095149726401658, 26.134492680873098, 26.171704951773616, 26.20830541180921, 26.24652181898018, 26.28514761465041, 26.323021759956635, 26.361716537757374, 26.399505863160176, 26.43728409732429, 26.473979478078864, 26.51160452513389, 26.548145005468115, 26.585268998644146, 26.622562110161, 26.659066639868662, 26.696648678192187, 26.73462325383218, 26.771949671063123, 26.8096863829229, 26.84667736753251, 26.883878994296175, 26.921070301303477, 26.958110692111468, 26.99617806380562, 27.033215903312122, 27.070032525690078, 27.107015782670587, 27.144394160334624, 27.181873383388616, 27.21962688249372, 27.256552046678102, 27.294777637472198, 27.33292457497654, 27.37021988312522, 27.40915134142938, 27.44655087113001, 27.48437507479519, 27.521815228720605, 27.5597154773511, 27.597932514007084, 27.63600962282603, 27.67365202840606, 27.713168392206022, 27.75153978747119, 27.78962709525316, 27.827808959850937, 27.86588753561101, 27.9040277622081, 27.943673218558246, 27.982590640457037, 28.021807740958344, 28.06092341128775, 28.100821243417514, 28.138796091328015, 28.177701955523844, 28.21661560661127, 28.25474999242069, 28.29431500869464, 28.333409864693298, 28.37217274177323, 28.411653089565416, 28.451729569802968, 28.49233781840352, 28.53186348956987, 28.571865940317252, 28.611336956976018, 28.652047014870785, 28.69140546225747, 28.72980704684806, 28.769759439262767, 28.810816951267935, 28.85122256146081, 28.89305787799578, 28.934099495686137, 28.976756222190474, 29.018047866660222, 29.0605323430804, 29.102540864587798, 29.145422655008193, 29.186951540611634, 29.22854362003359, 29.27321684450339, 29.316177457428143, 29.359798263131697, 29.401887315960757, 29.445871278286642, 29.489181038893467, 29.53120633473991, 29.57411673072997, 29.616982865990074, 29.65919472057367, 29.70013308648086, 29.7437450935264, 29.78788474476281, 29.829577086766257, 29.872817856442904, 29.915949551976446, 29.959128904805812, 30.004819035444388, 30.052191003473517, 30.09692370698147, 30.142196973759646, 30.187845312162835, 30.232554110797484, 30.276725334757625, 30.324535778845792, 30.367189939512, 30.410662031862277, 30.456779940268053, 30.503668063089435, 30.550939690367496, 30.598827543033487, 30.64702916685248, 30.696718461065306, 30.742740074737384, 30.78910205240035, 30.83657727729891, 30.884385251297918, 30.931778671019806, 30.979156401425683, 31.027158082221177, 31.075257862542323, 31.1245707890789, 31.17265686118828, 31.223767557938235, 31.27230571070126, 31.324074229032632, 31.37258837963278, 31.423593671457894, 31.473461137933327, 31.52538737527282, 31.577304648279792, 31.627340180551265, 31.678093299083695, 31.73021201428159, 31.780970964582057, 31.83153125858346, 31.8874255491195, 31.94156854041107, 31.995931819545184, 32.05317695062151, 32.110771412990395, 32.1674306228153, 32.22119026046294, 32.2766345458483, 32.32870925707422, 32.383761235568976, 32.442416315380925, 32.498064125076326, 32.55418999602146, 32.61038905906531, 32.665375360003765, 32.72359833672138, 32.78252707794465, 32.84061038866812, 32.90066312381903, 32.961351521462305, 33.022107998612086, 33.077796792978454, 33.136530455795416, 33.193598238817195, 33.253892139274676, 33.3128179323847, 33.36968977179924, 33.43287519934639, 33.49262556410944, 33.553861363938346, 33.618169427226846, 33.67880393401459, 33.74102587812668, 33.80724527877358, 33.87883267827904, 33.94790914124127, 34.013095427441996, 34.07822134246203, 34.146602327563876, 34.2124246001374, 34.281609063209636, 34.34751496642333, 34.41761277288638, 34.48451946888365, 34.55466596429045, 34.620037582638986, 34.692353258565134, 34.76584466398704, 34.83393086188109, 34.91164854912518, 34.98654829301835, 35.06289170274547, 35.145566471244756, 35.219239246727774, 35.28999689040674, 35.36427616490368, 35.44145920750881, 35.51850537887415, 35.598835300513755, 35.676456747231974, 35.760911291517765, 35.8470510538614, 35.9289179554921, 36.00840647596601, 36.091581360449965, 36.172963733817795, 36.24949575076549, 36.33775368268259, 36.419629963368905, 36.50757442808919, 36.59397087677978, 36.682576404047374, 36.76242866474093, 36.850718744231436, 36.93907525002622, 37.042215750920974, 37.13381396479791, 37.225382598081026, 37.320235534525686, 37.41869821112381, 37.51027453113095, 37.612341698667066, 37.71594112593485, 37.81926025254587, 37.91535191271779, 38.02353246586361, 38.123295961982265, 38.22308137642757, 38.33403679326014, 38.44626507734909, 38.5533118305772, 38.67377515295206, 38.793406950409484, 38.90511212858001, 39.03678978234087, 39.15748552193307, 39.28356789309828, 39.39576744162154, 39.51226093703688, 39.64390402598718, 39.772026301950575, 39.90920042370579, 40.0564335868978, 40.19379924468335, 40.336288631664694, 40.472240180173024, 40.619230683605885, 40.76786548911024]
	# pixel cx
	# psnrs_p = [17.379286219791435, 18.273517638528237, 18.799753322859633, 19.27104964702192, 19.5671722702615, 19.819556966365546, 20.032484142316758, 20.276680683746008, 20.476240021493812, 20.67954332667222, 20.834505888017212, 20.985069452762147, 21.129310333388887, 21.248161719090472, 21.373506559734206, 21.494800956270073, 21.6137720612599, 21.73149596212894, 21.845152484843897, 21.94782255242223, 22.04998923679071, 22.141933095213442, 22.23086186790402, 22.319558921841868, 22.401324269775674, 22.491361802066628, 22.57468492847926, 22.652648391495017, 22.74523431305865, 22.822125933383937, 22.893504009563184, 22.966689410028803, 23.044238741370553, 23.11864933656793, 23.194102769218663, 23.26468478166263, 23.337492313642063, 23.408574866719995, 23.476573019752465, 23.54190694445113, 23.60680808044171, 23.669946244499435, 23.7305375222872, 23.79267428076248, 23.856432105626244, 23.9189924384796, 23.972804565667197, 24.03541623984945, 24.09795566830381, 24.15618389607295, 24.213591299973498, 24.267006666074085, 24.320795881440898, 24.372122451990375, 24.423313596073616, 24.475870497326596, 24.528835091709812, 24.58035188105079, 24.629767297892208, 24.680503631306255, 24.734085337558987, 24.786517870389456, 24.835492787444895, 24.88075528456821, 24.928085155318076, 24.974358893918982, 25.022365504853894, 25.067085605384644, 25.107957945884003, 25.151161975173686, 25.19480614238047, 25.24028393540852, 25.283282383345554, 25.32729032143603, 25.37070286952575, 25.413559307267036, 25.457917205805682, 25.501922187693946, 25.54656064830142, 25.589163868050147, 25.632552554830795, 25.67520278925933, 25.72009204796513, 25.762799547634646, 25.807002975879417, 25.851558840829576, 25.893608541025596, 25.934948352279417, 25.977826950973597, 26.019693145377477, 26.06054441621219, 26.102077734058714, 26.141261288094842, 26.184117266066362, 26.22315123752469, 26.263825383054705, 26.30684088511764, 26.34605180111359, 26.384723953802837, 26.422377664841406, 26.46173831263639, 26.501084007229007, 26.540818226064413, 26.577794401404525, 26.61332267791699, 26.64900631956251, 26.685959847329602, 26.723866909472253, 26.762428588446056, 26.799065785402423, 26.837062977170643, 26.87581273157525, 26.91446722693717, 26.948897366104003, 26.986979645621645, 27.023582987280115, 27.059521957317273, 27.09650134713432, 27.1340248872209, 27.17170044150911, 27.20913594591586, 27.246652722506685, 27.283555514314553, 27.319010777010217, 27.356839976624812, 27.39290236750175, 27.42888676430204, 27.46696876992541, 27.50409424095356, 27.542050512360735, 27.57936904122437, 27.61525286733363, 27.650012589538566, 27.688272705216256, 27.725792335306217, 27.763025648856562, 27.79903304222055, 27.83563793606621, 27.873564956861237, 27.90805883820868, 27.943857584602473, 27.9804998887022, 28.016547643261625, 28.053392801809213, 28.090651280805126, 28.127526340682753, 28.16386601460967, 28.200370686885186, 28.238323262527707, 28.274738601768274, 28.312115470367694, 28.347627525878995, 28.383273327001124, 28.419546845868663, 28.45627648457906, 28.49395032363163, 28.53016760356795, 28.56815460767441, 28.606026308741622, 28.642898140975685, 28.680154222836073, 28.71683953016489, 28.754332133460213, 28.79083301365383, 28.826874805939667, 28.864566060953514, 28.901506116665566, 28.939941417363936, 28.976419191613097, 29.015045697649207, 29.05269318020414, 29.091284862172973, 29.130260801801708, 29.166236027276423, 29.204436178755714, 29.242457629233968, 29.281903539306118, 29.31862393970945, 29.35722576704482, 29.394499184941974, 29.433287632388534, 29.470936488088217, 29.511090704621335, 29.54878677007624, 29.58637999613535, 29.62518565109192, 29.663644990767533, 29.701190513127365, 29.740165835345273, 29.77868366546762, 29.817304532642737, 29.85798371407036, 29.89607618326012, 29.93513630172139, 29.974086908387463, 30.014221325655537, 30.05299699788379, 30.09081934534029, 30.13102314152626, 30.169878890013944, 30.208563321181675, 30.247590447114703, 30.285503309954002, 30.325103266944364, 30.363966841564807, 30.40514505415987, 30.44510217297824, 30.483762231683325, 30.524579014153606, 30.565673536442524, 30.604684151485706, 30.6446230950548, 30.686381890947995, 30.72681309246647, 30.767245380699208, 30.808461325630436, 30.850134105220366, 30.891245297619523, 30.931607266880803, 30.97358101502723, 31.01443510354309, 31.0557362582709, 31.096961005683713, 31.139132990656456, 31.18230879375081, 31.22424830189793, 31.266675543074214, 31.309073811138507, 31.351055282074515, 31.39441384260756, 31.436907150895472, 31.480627887345182, 31.52342500689416, 31.566549680560062, 31.60927278367501, 31.652474456942905, 31.69507315932426, 31.738811505813562, 31.782371877396688, 31.825847649941068, 31.8695846331396, 31.9156508207774, 31.960199991252146, 32.00486674438555, 32.04959901140218, 32.093452964076, 32.13885413228073, 32.18540461544698, 32.23055276736731, 32.27572972725542, 32.322412862000704, 32.369753383372306, 32.41517310548142, 32.46206862095876, 32.510827216637956, 32.5593092749108, 32.607281351069204, 32.65610340905349, 32.70449161442391, 32.75384984104366, 32.80159397805454, 32.851010247118374, 32.90040940289326, 32.94977498499549, 32.999909088533684, 33.04953236260637, 33.098465613719696, 33.14860402898097, 33.199998431108504, 33.250780862068716, 33.30169854093947, 33.35430351743931, 33.407292957889396, 33.45951994744789, 33.51174412633352, 33.564167400726426, 33.616765724106, 33.668191504969826, 33.72101226250448, 33.773972414510354, 33.82887508940338, 33.882684449820516, 33.9368824881518, 33.99236941937633, 34.0482916972072, 34.1040804554432, 34.16089821661997, 34.21702454292962, 34.274791122839694, 34.331558733853036, 34.389954728529545, 34.44854010271767, 34.506978392245124, 34.56618031428384, 34.62494866049875, 34.685493158202576, 34.74535571503704, 34.80662332761737, 34.867228285664076, 34.92851248717038, 34.99154855797693, 35.05347467052488, 35.11678856255518, 35.18178071398574, 35.2453323376763, 35.30956849918778, 35.37631941837439, 35.442787944596965, 35.509845347641665, 35.57724107163984, 35.64568585643834, 35.71426981879491, 35.78413975938012, 35.852628132200955, 35.92172712177845, 35.99082385085831, 36.062748026473535, 36.134331818545064, 36.20819302696119, 36.28162873133144, 36.35691175085478, 36.4326377809386, 36.50943815119503, 36.58704008148212, 36.66690808831207, 36.74453165773454, 36.82668357826791, 36.90769137422888, 36.9916625174667, 37.073745072738674, 37.15897628615833, 37.24526070013609, 37.33077881988072, 37.419429969768494, 37.50816510940898, 37.599701477191815, 37.69177031621732, 37.784706711575836, 37.87713879618049, 37.975242501170584, 38.07323477752903, 38.17005136125848, 38.271910028357404, 38.37286974016668, 38.475115700660524, 38.58013524238227, 38.6853555853358, 38.79412378253532, 38.90730220544205, 39.02000586318202]
	# m_ = [1, 7, 302] #  67,
	# p_ = [17.379286219791435, 20.032484, 35.053475] # 25.022366,
	# image nn
	# psnrs = [17.15048262058504, 17.840267588185235, 18.272249279366285, 18.639833966023204, 19.025565738075457, 19.309127072886742, 19.516956146457492, 19.729211508752794, 19.937314943821317, 20.140308309380874, 20.321826835944936, 20.479685885757835, 20.648398788654777, 20.784224732871042, 20.915818147656218, 21.042338301635063, 21.154618512275903, 21.27345541273101, 21.38829964059408, 21.493501724796147, 21.59273953524431, 21.688788346569194, 21.791090391852165, 21.884072102319433, 21.972002807036016, 22.05255042466959, 22.13203300807108, 22.20913208293043, 22.286151598975554, 22.36157920003554, 22.431190951168983, 22.510006427911186, 22.579485304540587, 22.650662857945218, 22.72046464901813, 22.791737897138454, 22.85832049777619, 22.92640667595242, 22.994730755197875, 23.057907653177278, 23.11871712493019, 23.177042925223763, 23.23708074381617, 23.296670803976294, 23.351002307260806, 23.413811939578036, 23.4680587551395, 23.526555610392094, 23.587103991144883, 23.644058707722525, 23.701062753885626, 23.75596572897138, 23.80760546304414, 23.85993665612287, 23.91137258464806, 23.962602665900203, 24.015394054667414, 24.064759745840227, 24.114157200830537, 24.15947297836028, 24.210125694029475, 24.26104189239097, 24.310501137005613, 24.35804018987307, 24.40451296324385, 24.450609735755133, 24.49479909097663, 24.53909007104561, 24.582396199073276, 24.62880212392336, 24.672514444252375, 24.71561394030587, 24.758125837512658, 24.802172521562287, 24.844100198065675, 24.887577559955773, 24.93033551294473, 24.973307038133047, 25.015268071292795, 25.058018511545782, 25.09999588014183, 25.14227470958505, 25.183035127783565, 25.225228750263742, 25.26550979180613, 25.305598363212884, 25.34626402883946, 25.386916218077427, 25.425391325180616, 25.46548149148345, 25.507270623893636, 25.545490996576053, 25.587099768206073, 25.6275434735842, 25.66735376473447, 25.708084293213204, 25.746956473560914, 25.78675162322832, 25.824107350950015, 25.863053090290567, 25.902548685236805, 25.939931815682957, 25.97738302108358, 26.014607615081342, 26.052232325770476, 26.08956109659065, 26.12712947562879, 26.16480794589669, 26.205304156282928, 26.243456413541583, 26.281919936246297, 26.319317540108045, 26.358390258776545, 26.394669240237107, 26.43182942116461, 26.46829134002408, 26.505517329769905, 26.543238141773102, 26.581087897563553, 26.6178524920952, 26.65508103291163, 26.691803629129563, 26.73005632021055, 26.768732925242038, 26.806550785458185, 26.84311861609899, 26.88055990048192, 26.91807950782732, 26.95551053168975, 26.99351860745743, 27.029722363076665, 27.065636466546906, 27.102524320118192, 27.139591239118882, 27.176900795919646, 27.215099204525387, 27.25406049594977, 27.29163541428561, 27.32896070921483, 27.365076350606515, 27.40366701156211, 27.441803229046865, 27.48023008715019, 27.516676718285463, 27.553980679175, 27.592305291738583, 27.62967423287768, 27.667883985022964, 27.707568327934, 27.744773355208686, 27.782975041574492, 27.82103199699438, 27.8588535984398, 27.89749881461715, 27.936074287646107, 27.97510074843266, 28.013793494219595, 28.05108307917926, 28.091346336320683, 28.13015763544822, 28.16667885558781, 28.20575855022605, 28.244572880617557, 28.283559361052557, 28.32299553122203, 28.362102778020482, 28.401711881371938, 28.44179279239099, 28.48256906533228, 28.524147701099277, 28.56276300114618, 28.604161336322104, 28.644934704760434, 28.683368606408568, 28.723240779361127, 28.76350319818753, 28.804592904145384, 28.845954319245962, 28.888024208324076, 28.928526888398846, 28.96928335700752, 29.010621895567816, 29.052550934845577, 29.093102666681435, 29.134456623389823, 29.179149785080057, 29.223161430496486, 29.26350147714471, 29.30655484430651, 29.34922980018804, 29.3916141237968, 29.433233711640604, 29.475368781076345, 29.521225753589924, 29.564415298320256, 29.605029752149264, 29.64802721289327, 29.69008820365202, 29.73070387291119, 29.776476059341707, 29.818219592125423, 29.86005742830088, 29.90428873766009, 29.947944238527747, 29.993157703339886, 30.03869489554246, 30.085175075680073, 30.13265034255596, 30.17615475023087, 30.22032112101735, 30.266523674256415, 30.308233596514082, 30.349930428739153, 30.3969560938854, 30.444693257473304, 30.488811491454893, 30.53615375427863, 30.58262760860309, 30.630230779898262, 30.678440726548523, 30.726237013914833, 30.771001346345102, 30.81806043302387, 30.86314393505617, 30.91133291886389, 30.958215168658036, 31.005986218936563, 31.05541627286841, 31.104348396463216, 31.157439291009258, 31.207916016796425, 31.25902161310539, 31.30732706943973, 31.354359190194568, 31.406145939174902, 31.45900219209996, 31.505600305438534, 31.55586899308085, 31.606728582936046, 31.657754708212437, 31.71178227589907, 31.761425545314463, 31.813645451821312, 31.866245397547512, 31.919596387440844, 31.974123063550827, 32.03277791444818, 32.08789592110308, 32.147457719617826, 32.20199506869031, 32.255884955572526, 32.31002019734468, 32.363367945907086, 32.4166951540314, 32.47121282836898, 32.527632124299565, 32.57924361389615, 32.63470871547829, 32.69398137570635, 32.7456045064091, 32.80220820817358, 32.86251760923196, 32.922347023074536, 32.98542330788908, 33.03945773238764, 33.09952140547724, 33.15778021518914, 33.21381880704982, 33.27121079452933, 33.332950405390136, 33.396038158566604, 33.45456304572756, 33.51823871055246, 33.57593067196026, 33.63704993433489, 33.70050734962868, 33.765608863268376, 33.82743703733135, 33.89267819295703, 33.96423264185997, 34.027849320676204, 34.09555615117364, 34.1686016381976, 34.23525330619273, 34.305349905315346, 34.3711565990059, 34.435721154074514, 34.50416705942826, 34.57406886536338, 34.64349470820665, 34.72631028146172, 34.79944405039615, 34.86864048787968, 34.94008869169707, 35.01570467353141, 35.094611940286214, 35.165295675366394, 35.23806900480059, 35.31946912607756, 35.39136504406047, 35.46916788219843, 35.54973815689067, 35.62454286249666, 35.70580832172145, 35.78160745425994, 35.86788882074735, 35.94473780543101, 36.02184427573276, 36.104728318299124, 36.184257777318386, 36.2681458257033, 36.35991097358924, 36.43421777328409, 36.5116668980239, 36.59064335994024, 36.66426569573838, 36.7517333268159, 36.84123958477722, 36.93384650428239, 37.025300095222576, 37.128069596982435, 37.22400739053408, 37.3186536197945, 37.418092754304396, 37.51157253653112, 37.61477234354383, 37.70179595129005, 37.81601243741181, 37.919870241875, 38.02145382319711, 38.11986247167992, 38.22536664742172, 38.3276868118998, 38.436223845521276, 38.53712140559342, 38.648153460045485, 38.75909029295822, 38.87560805299775, 38.9971724479515, 39.11296275186873, 39.21597629343757, 39.333549699273554, 39.47364121199829, 39.60864061050725, 39.7441809638615, 39.876400131149566, 40.00026332249506, 40.14334521015915, 40.29354795641722, 40.4405008150222]
	# m_ = [1, 10, 295]
	# p_ = [17.150483, 20.321827, 35.015705]
	# fig = plt.figure(1, figsize=(6, 4.5))
	# plt.plot(ms, psnrs)
	# # plt.plot(ms, psnrs_i, label='Image', color='b')
	# # plt.plot(ms, psnrs_p, label='Pixel', color='r')
	# # plt.legend(['Image', 'Pixel'], loc='lower right')
	# plt.scatter(m_, p_, marker='o', color='red', s=30)
	# for a, b in zip(m_, p_):  
	# 	plt.text(a, b, (a,b),ha='left', va='top', fontsize=10)
	plt.xlabel('M')
	plt.ylabel('PSNR')
	plt.title('PSNR-M NN')
	plt.savefig('imgs/psnr_%s_%s.png' % (opt.type, opt.method))


if __name__ == '__main__':
    main()